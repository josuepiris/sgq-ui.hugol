<div class="container">
  <div class="grid">

    <div class="col-12">
      <p-breadcrumb [model]="breadcrumbItems" [home]="home"></p-breadcrumb>
    </div>

    <div class="col-12 pt-0">
      <p-panel header="Filtros" [toggleable]="true" [collapsed]="true" >
  
        <form autocomplete="off" (ngSubmit)="pesquisar()">
          <div class="grid">
            <div class="col-12 md:col-2 p-fluid">
              <label>Código</label>
              <input pInputText type="text" name="codigo" [(ngModel)]="filtro.codigo">
            </div>
    
            <div class="col-12 md:col-10 p-fluid">
              <label>Nome</label>
              <input pInputText type="text" name="nome" [(ngModel)]="filtro.nome">
            </div>
    
            <div class="col-12 md:col-2 ml-auto p-fluid">
              <button pButton type="submit" label="Pesquisar"
                  icon="pi pi-search" iconPos="right"></button>
            </div>
          </div>
  
  
        </form>
  
      </p-panel>
    </div>

    <div class="col-12 pt-0">
      <p-table [value]="pessoas"
        [paginator]="true" [rows]="filtro.itensPorPagina"
        [lazy]="true" [totalRecords]="totalRegistros"
        (onLazyLoad)="aoMudarPagina($event)" autoLayout="true"
        styleClass="p-datatable-sm p-datatable-gridlines p-datatable-striped"
        #tabela>
        <ng-template pTemplate="header">
          <tr>
            <th class="w-10rem text-center">Código</th>
            <th>Nome</th>
            <th>Departamento</th>
            <th class="w-1rem"></th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-pessoa>
          <tr>
            <td class="text-center">{{ pessoa.funcionarioId }}</td>
            <td>{{ pessoa.nome }}</td>
            <td>{{ pessoa.departamento.nome }}</td>
            <td class="flex gap-2">
              <p-button [label]="pessoa.ativo ? 'Ativo' : 'Inativo'" size="small" [link]="true"
                [pTooltip]="pessoa.ativo ? 'Desativar' : 'Ativar'" tooltipPosition="top" 
                (onClick)="alternarStatus(pessoa)" id="botaoStatus" [disabled]="pessoa.funcionarioId === 1" />

              <p-button severity="warning" icon="pi pi-pencil" pTooltip="Editar" tooltipPosition="top"
              [routerLink]="['/funcionarios', pessoa.funcionarioId]" [disabled]="pessoa.funcionarioId === 1" />
              
              <p-button severity="danger" icon="pi pi-trash" pTooltip="Excluir" tooltipPosition="top"
                (onClick)="confirmarExclusao(pessoa)" [disabled]="pessoa.funcionarioId === 1" />
            </td>
          </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="4">
              Nenhuma registro encontrado!
            </td>
          </tr>
        </ng-template>

        <ng-template pTemplate="footer" let-columns>
          <tr>
            <td colspan="4" style="text-align: center">
                Qtd. de Registros: {{ totalRegistros }}
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>

    <div class="col-12 md:col-2 pt-0 ml-auto p-fluid">
      <p-button label="Cadastrar" icon="pi pi-plus" routerLink="/funcionarios/novo" />
    </div>

  </div>

</div>
